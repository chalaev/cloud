cloud> make
[ -d generated/from/ ] || mkdir -p generated/from/
[ -d generated/headers/ ] || mkdir -p generated/headers/
[ -d generated/tests/ ] || mkdir -p generated/tests/
emacsclient -e '(progn (load "/home/shalaev/Private/work/cloud/helpers/derive-version.el") (printangle "cloud.org"))' | xargs echo > generated/from/cloud.org
emacsclient -e '(progn (load "/home/shalaev/Private/work/cloud/helpers/derive-version.el") (printangle "2.org"))' | xargs echo > generated/from/2.org
emacsclient -e '(progn (load "/home/shalaev/Private/work/cloud/helpers/derive-version.el") (format-version "change-log.org"))' | xargs echo > version.org
sed "s/the-version/`head -n1 version.org`/" header.el > packaged/cloud.el
cat 0.el 1.el generated/2.el generated/variables.el generated/functions.el >> packaged/cloud.el
echo "(provide 'cloud)" >> packaged/cloud.el
echo ";;; cloud.el ends here" >> packaged/cloud.el
emacsclient -e '(untilde (cdr (assoc "local-packages" package-archives)))' | xargs cp packaged/cloud.el
cat generated/micro.el generated/micro-2.el > generated/tests/micro.el

-= Testing on MICRO scale: =-

emacs -q --no-site-file --batch -l goodies/start.el -l packaged/cloud.el -l generated/tests/micro.el -f ert-run-tests-batch-and-exit 2> generated/tests/micro.log

12/24 10:05 MICRO TESTS PASSED :)

emacsclient -e '(progn (load "/home/shalaev/Private/work/cloud/helpers/derive-version.el") (printangle "testing.org"))' | xargs echo > generated/from/testing.org
cat generated/headers/tests.el generated/headers/meso.el generated/meso-0.el generated/meso.el > generated/tests/meso.el

-= Testing on MESO scale: =-

emacs -q --no-site-file --batch -l goodies/start.el -l packaged/cloud.el -l generated/tests/meso.el  -f ert-run-tests-batch-and-exit 2> generated/tests/meso.log

12/24 10:05 MESO TESTS PASSED :)

cat generated/headers/tests.el generated/headers/meso.el generated/macro.el > generated/tests/macro.el

-= Testing on MACRO scale: =-

emacs -q --no-site-file --batch -l goodies/start.el -l packaged/cloud.el -l generated/tests/macro.el -f ert-run-tests-batch-and-exit 2> generated/tests/macro.log

12/24 10:06 MACRO TESTS PASSED :)

rm generated/headers/make: unlink: generated/headers/: Is a directory
 generated/from/make: unlink: generated/from/: Is a directory
 generated/tests/make: unlink: generated/tests/: Is a directory
